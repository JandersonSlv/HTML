<!DOCTYPE html>
<html>
<head>
  <title>Cadastro de Produtos</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h2>Cadastro de Produtos</h2>
<form id="produtoForm">
    Nome: <input type="text" id="nome"><br><br>
    Descrição: <input type="text" id="descricao"><br><br>
    Preço: <input type="number" step="0.01" id="preco"><br><br>
    <button>Cadastrar</button>
</form>

<h2>Lista de Produtos</h2>
<table border="1" id="tabelaProdutos">
    <thead>
        <tr><th>ID</th><th>Nome</th><th>Descrição</th><th>Preço</th></tr>
    </thead>
    <tbody></tbody>
</table>

<script>
const form = document.getElementById('produtoForm');
const tabela = document.querySelector('#tabelaProdutos tbody');

// Listar
async function listar() {
    const res = await fetch('/produtos');
    const produtos = await res.json();

    tabela.innerHTML = "";
    produtos.forEach(p => {
        let row = tabela.insertRow();
        row.insertCell().textContent = p.id;
        row.insertCell().textContent = p.nome;
        row.insertCell().textContent = p.descricao;
        row.insertCell().textContent = p.preco;
    });
}

// Cadastrar
form.addEventListener('submit', async (e)=> {
    e.preventDefault();
    await fetch('/produtos', {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            nome: nome.value,
            descricao: descricao.value,
            preco: preco.value
        })
    });

    form.reset();
    listar();
});

listar();
</script>
</body>
</html>